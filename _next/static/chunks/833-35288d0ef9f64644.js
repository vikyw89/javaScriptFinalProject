"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{6833:function(e,t,i){let r;i.d(t,{G:function(){return x}});var n=i(5893),s=i(7294),a=i(9744),l=i(7997),o=i(8201),u=i(5675),d=i.n(u),c=i(1163);let f=new Map,m=new WeakMap,p=0;var h=i(5969);let v=e=>{var t;let{props:i}=e,{index:u,feeds:v,setPinsToDisplay:g,refetchFn:w,infinite:x}=i,{data:b}=(0,a.a)(),j=null==v?void 0:v.length,[y,N]=(0,s.useState)(),E=null==v?void 0:v[y],_=(0,c.useRouter)(),[S,L]=(0,s.useState)(!1),{entry:R,ref:k}=function({threshold:e,delay:t,trackVisibility:i,rootMargin:n,root:a,triggerOnce:l,skip:o,initialInView:u,fallbackInView:d,onChange:c}={}){var h;let[v,g]=s.useState(null),w=s.useRef(),[x,b]=s.useState({inView:!!u,entry:void 0});w.current=c,s.useEffect(()=>{let s;if(!o&&v)return s=function(e,t,i={},n=r){if(void 0===window.IntersectionObserver&&void 0!==n){let r=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:"number"==typeof i.threshold?i.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),()=>{}}let{id:s,observer:a,elements:l}=function(e){let t=Object.keys(e).sort().filter(t=>void 0!==e[t]).map(t=>{var i;return`${t}_${"root"===t?(i=e.root)?(m.has(i)||(p+=1,m.set(i,p.toString())),m.get(i)):"0":e[t]}`}).toString(),i=f.get(t);if(!i){let r;let n=new Map,s=new IntersectionObserver(t=>{t.forEach(t=>{var i;let s=t.isIntersecting&&r.some(e=>t.intersectionRatio>=e);e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=s),null==(i=n.get(t.target))||i.forEach(e=>{e(s,t)})})},e);r=s.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:t,observer:s,elements:n},f.set(t,i)}return i}(i),o=l.get(e)||[];return l.has(e)||l.set(e,o),o.push(t),a.observe(e),function(){o.splice(o.indexOf(t),1),0===o.length&&(l.delete(e),a.unobserve(e)),0===l.size&&(a.disconnect(),f.delete(s))}}(v,(e,t)=>{b({inView:e,entry:t}),w.current&&w.current(e,t),t.isIntersecting&&l&&s&&(s(),s=void 0)},{root:a,rootMargin:n,threshold:e,trackVisibility:i,delay:t},d),()=>{s&&s()}},[Array.isArray(e)?e.toString():e,v,a,n,l,o,i,d,t]);let j=null==(h=x.entry)?void 0:h.target,y=s.useRef();v||!j||l||o||y.current===j||(y.current=j,b({inView:!!u,entry:void 0}));let N=[g,x.inView,x.entry];return N.ref=N[0],N.inView=N[1],N.entry=N[2],N}({skip:S}),C=(0,l.a)(),I=null==C?void 0:null===(t=C.data)||void 0===t?void 0:t.boards,[M,V]=(0,s.useState)(),[z,O]=(0,s.useState)(!1);(0,s.useEffect)(()=>(u.current++,()=>{u.current--}),[u]),(0,s.useEffect)(()=>{N(u.current)},[]),(0,s.useEffect)(()=>{(null==R?void 0:R.isIntersecting)&&(g(e=>[...e,"dummy"]),L(!0))},[null==R?void 0:R.isIntersecting,g]),(0,s.useEffect)(()=>{y&&j<=y+30&&(x?w():L(!0))},[y,j,x,w]),(0,s.useEffect)(()=>{V(null==I?void 0:I[0])},[I]);let W=e=>{e.stopPropagation();let t=JSON.parse(e.target.value);V(t)},q=e=>{e.currentTarget.classList.add("animate-ping"),_.push("/pin/".concat(E.uuid))},A=e=>{e.classList.remove("animate-pulse"),e.classList.add("animate-fade-up","animate-once","animate-ease-in-out","animate-normal"),e.removeEventListener("onLoadingComplete",A)},P=e=>{e.stopPropagation(),O(!0)},B=e=>{e.stopPropagation(),O(!1)};return(0,n.jsxs)("div",{className:"flex flex-col relative gap-1 hover:cursor-zoom-in",onClick:q,ref:k,children:[!E&&(0,n.jsx)("div",{className:"w-72 max-w-full aspect-square bg-base-300 animate-jump animate-infinite animate-duration-[2000ms] animate-delay-500 animate-ease-in-out animate-normal rounded-3xl"}),E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"w-72 max-w-full h-auto relative",onMouseEnter:P,onMouseLeave:B,children:[(0,n.jsx)(d(),{src:E.image_url,alt:"pinImage",width:300,height:300,sizes:"300px",priority:!0,placeholder:"blur",blurDataURL:E.loading_image_url,className:"h-auto w-full rounded-3xl bg-neutral animate-pulse",onLoadingComplete:A}),b&&z&&(0,n.jsxs)("div",{className:"absolute p-2 top-0 right-0 left-0 bottom-0 z-20 hover:backdrop-brightness-50 flex justify-between rounded-3xl animate-fade animate-once animate-duration-300 animate-ease-in-out",children:[(0,n.jsx)("select",{className:"select max-w-xs bg-neutral text-neutral-content",onChange:W,children:I&&I.map((e,t)=>(0,n.jsx)("option",{value:JSON.stringify(e),children:e.title},t))}),M&&(0,n.jsx)(h.t,{props:{pin_uuid:E.uuid,board_uuid:M.uuid}})]})]}),(0,n.jsx)("div",{className:"pl-3 pr-3 font-bold overflow-clip overflow-ellipsis",children:E.title}),(0,n.jsxs)("div",{className:"flex max-w-full items-center gap-2 pl-3 pr-3 overflow-clip overflow-ellipsis",children:[(0,n.jsx)("div",{className:"avatar aspect-square",children:(0,n.jsx)("div",{className:"w-8 rounded-full flex items-center",children:E.users.profile_picture_url?(0,n.jsx)(d(),{src:E.users.profile_picture_url,alt:"avatar",width:"0",height:"0",className:"w-full aspect-square",id:"profilePicture"}):(0,n.jsx)(o.Z,{className:"w-full aspect-square"})})}),(0,n.jsx)("div",{className:"overflow-ellipsis overflow-clip",children:E.users.username})]})]})]})},g=e=>{let{props:t}=e,[i,r]=(0,s.useState)(["dummy"]);return(0,n.jsx)("div",{className:"h-max flex flex-col gap-5 w-72 max-w-full overflow-hidden",children:i&&i.map((e,i)=>(0,n.jsx)(v,{props:{...t,setPinsToDisplay:r}},i))})},w=300;window.innerWidth<=500&&(w=window.innerWidth/2);let x=e=>{let{props:t}=e,{feeds:i}=t,r=(0,s.useRef)(-1),[a,l]=(0,s.useState)(["dummy"]);return(0,s.useEffect)(()=>{let e=e=>{let t=[],i=e?e.target.innerWidth:window.innerWidth,r=Math.floor(i/w);for(let e=0;e<r;e++)t.push("dummy");l(t)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,s.useEffect)(()=>{let e=window.innerWidth,t=Math.floor(e/w),i=[];for(let e=0;e<t;e++)i.push("dummy");l(i)},[]),(0,n.jsx)("div",{className:"w-full",children:i&&(0,n.jsx)("div",{className:"flex gap-1 md:gap-5 justify-center p-1 md:p-5",children:0!==i.length&&a&&a.map((e,i)=>(0,n.jsx)(g,{props:{...t,index:r}},i))})})}}}]);