"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[578],{1243:function(e,t,s){s.d(t,{T:function(){return N}});var r=s(5893),n=s(1163),l=s(7294),a=s(664);let i=()=>{let e=(0,n.useRouter)(),t=(0,a.m)("route/loading"),s=(0,a.m)("loadingCounter");return(0,l.useEffect)(()=>{let t=()=>{(0,a._)("route/loading",!0)},s=()=>{(0,a._)("route/loading",!1)};return e.events.on("routeChangeStart",t),e.events.on("routeChangeComplete",s),()=>{e.events.off("routeChangeStart",t),e.events.off("routeChangeComplete",s)}},[e]),(0,r.jsx)("div",{className:"fixed z-50 top-12 w-full flex",children:(t||s>0)&&(0,r.jsx)("progress",{className:"progress progress-accent"})})};var o=s(9744);let d=()=>{let e=(0,a.m)("theme");return(0,l.useEffect)(()=>{(0,a._)("theme",["light","dark","cupcake","bumblebee","emerald","corporate","synthwave","retro","cyberpunk","valentine","halloween","garden","forest","aqua","lofi","pastel","fantasy","wireframe","black","luxury","dracula","cmyk","autumn","business","acid","lemonade","night","coffee","winter"].sort((e,t)=>e>t?1:-1))},[]),e};var c=s(7997),u=s(9557),h=s(8201),m=s(6540),x=s(5328),f=s(9485),p=s(3540),v=s(5675),g=s.n(v),j=s(4334);let b=()=>{var e,t,s,l,i,v;let b=null!==(v=d())&&void 0!==v?v:[],w=(0,o.a)(),N=(0,c.a)(),y=(0,n.useRouter)(),k=(0,j.Z)("api/auth",async()=>{let{error:e}=await u.O.auth.signOut();return e}),C=(0,j.Z)((null==w?void 0:null===(e=w.data)||void 0===e?void 0:null===(t=e.user)||void 0===t?void 0:t.id)&&"api/user/".concat(w.data.user.id),async(e,t)=>{let{arg:s}=t;await u.O.from("users").update({theme:s}).eq("uuid",w.data.user.id).throwOnError()}),_=null==w?void 0:null===(s=w.data)||void 0===s?void 0:null===(l=s.user)||void 0===l?void 0:null===(i=l.user_metadata)||void 0===i?void 0:i.avatar_url,E=()=>{(0,a._)("show/signInComponent",!0)},S=()=>{k.trigger()},I=()=>{y.push("/")},R=()=>{y.push("/createPin")},z=e=>{let t=e.target.textContent,s={optimisticData:{...N.data,theme:t}};C.trigger(t,s)},L=()=>{y.push("/profile")};return(0,r.jsxs)("div",{className:"flex bg-neutral z-20 items-center text-neutral-content",children:[(0,r.jsx)("div",{className:"flex-1 px-2 lg:flex-none flex items-center gap-1 cursor-pointer",children:(0,r.jsxs)("div",{onClick:I,className:"lg:flex-none flex items-center gap-1 cursor-pointer",children:[(0,r.jsx)("div",{className:"w-12",children:(0,r.jsx)(g(),{alt:"pinterest logo",src:"https://hffebrjtrzopihuffrxv.supabase.co/storage/v1/object/public/assets/p-logo-lowres.png",width:"0",priority:!0,height:"0",sizes:"100vw",className:"w-auto"})}),(0,r.jsx)("a",{className:"text-lg font-bold hidden sm:block",children:"Pinterest"})]})}),(0,r.jsxs)("div",{className:"flex justify-end flex-1 px-2 items-center",children:[w.data&&(0,r.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:R,children:[(0,r.jsx)("a",{className:"hidden sm:block",children:"Create"}),(0,r.jsx)("div",{className:" sm:hidden",children:(0,r.jsx)(m.Z,{})})]}),(0,r.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,r.jsxs)("button",{tabIndex:0,className:"btn p-2 btn-ghost rounded-btn",children:[(0,r.jsx)("label",{className:"hidden sm:block",children:"Theme"}),(0,r.jsx)("div",{className:"sm:hidden",children:(0,r.jsx)(x.Z,{})})]}),(0,r.jsx)("ul",{tabIndex:0,className:"menu dropdown-content p-2 shadow rounded-box w-52 mt-4 grid grid-cols-1 overflow-y-scroll max-h-screen bg-neutral",children:b&&b.map((e,t)=>(0,r.jsx)("li",{className:"text-neutral-content bg-neutral",children:(0,r.jsx)("a",{onClick:z,children:e})},t))})]}),w.data?(0,r.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:S,children:[(0,r.jsx)("a",{className:"hidden sm:block",children:"Sign Out"}),(0,r.jsx)("div",{className:"sm:hidden",children:(0,r.jsx)(p.Z,{})})]}):(0,r.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:E,children:[(0,r.jsx)("a",{className:"hidden sm:block",children:"Sign In"}),(0,r.jsx)("div",{className:"sm:hidden",children:(0,r.jsx)(f.Z,{})})]}),(0,r.jsx)("button",{className:"btn btn-ghost rounded-btn",onClick:L,children:(0,r.jsx)("div",{className:"avatar aspect-square",children:(0,r.jsx)("div",{className:"w-8 rounded-full flex items-center",children:_?(0,r.jsx)(g(),{src:_,alt:"avatar",width:"0",height:"0",className:"w-auto h-auto",id:"user_avatar"}):(0,r.jsx)(h.Z,{className:"text-3xl"})})})})]})]})},w=()=>{let e=(0,a.m)("error");return(0,r.jsx)("div",{className:"fixed bottom-0 left-0",children:e&&(0,r.jsx)("div",{className:"alert alert-error shadow-lg",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:e.message})]})})})},N=e=>{let{children:t}=e;return(0,r.jsxs)("div",{className:"fixed top-0 left-0 bottom-0 right-0 flex flex-col bg-base-100 text-base-content",children:[(0,r.jsx)(b,{}),(0,r.jsx)(i,{}),(0,r.jsx)("main",{className:"flex-1 overflow-y-auto flex flex-col",children:t}),(0,r.jsx)(w,{})]})}},6833:function(e,t,s){let r;s.d(t,{G:function(){return f}});var n=s(5893),l=s(7294),a=s(8201),i=s(5675),o=s.n(i),d=s(1163);let c=new Map,u=new WeakMap,h=0,m=e=>{let{props:t}=e,{index:s,feeds:i,setPinsToDisplay:m,refetchFn:x,infinite:f}=t;(0,l.useEffect)(()=>(s.current++,()=>{s.current--}),[s]);let p=null==i?void 0:i.length,[v,g]=(0,l.useState)();(0,l.useEffect)(()=>{g(s.current)},[]);let j=null==i?void 0:i[v],b=(0,d.useRouter)(),[w,N]=(0,l.useState)(!1),{entry:y,ref:k}=function({threshold:e,delay:t,trackVisibility:s,rootMargin:n,root:a,triggerOnce:i,skip:o,initialInView:d,fallbackInView:m,onChange:x}={}){var f;let[p,v]=l.useState(null),g=l.useRef(),[j,b]=l.useState({inView:!!d,entry:void 0});g.current=x,l.useEffect(()=>{let l;if(!o&&p)return l=function(e,t,s={},n=r){if(void 0===window.IntersectionObserver&&void 0!==n){let r=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:"number"==typeof s.threshold?s.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),()=>{}}let{id:l,observer:a,elements:i}=function(e){let t=Object.keys(e).sort().filter(t=>void 0!==e[t]).map(t=>{var s;return`${t}_${"root"===t?(s=e.root)?(u.has(s)||(h+=1,u.set(s,h.toString())),u.get(s)):"0":e[t]}`}).toString(),s=c.get(t);if(!s){let r;let n=new Map,l=new IntersectionObserver(t=>{t.forEach(t=>{var s;let l=t.isIntersecting&&r.some(e=>t.intersectionRatio>=e);e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=l),null==(s=n.get(t.target))||s.forEach(e=>{e(l,t)})})},e);r=l.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),s={id:t,observer:l,elements:n},c.set(t,s)}return s}(s),o=i.get(e)||[];return i.has(e)||i.set(e,o),o.push(t),a.observe(e),function(){o.splice(o.indexOf(t),1),0===o.length&&(i.delete(e),a.unobserve(e)),0===i.size&&(a.disconnect(),c.delete(l))}}(p,(e,t)=>{b({inView:e,entry:t}),g.current&&g.current(e,t),t.isIntersecting&&i&&l&&(l(),l=void 0)},{root:a,rootMargin:n,threshold:e,trackVisibility:s,delay:t},m),()=>{l&&l()}},[Array.isArray(e)?e.toString():e,p,a,n,i,o,s,m,t]);let w=null==(f=j.entry)?void 0:f.target,N=l.useRef();p||!w||i||o||N.current===w||(N.current=w,b({inView:!!d,entry:void 0}));let y=[v,j.inView,j.entry];return y.ref=y[0],y.inView=y[1],y.entry=y[2],y}({skip:w});(0,l.useEffect)(()=>{(null==y?void 0:y.isIntersecting)&&(m(e=>[...e,"dummy"]),N(!0))},[null==y?void 0:y.isIntersecting,m]),(0,l.useEffect)(()=>{v&&p<=v+10&&f&&x()},[v,p,f,x]);let C=()=>{b.push("/pin/".concat(j.uuid))},_=e=>{e.classList.remove("animate-pulse"),e.removeEventListener("onLoadingComplete",_)};return(0,n.jsxs)("div",{className:"flex flex-col relative gap-1",onClick:C,ref:k,children:[j&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-72 h-auto",children:(0,n.jsx)(o(),{src:j.image_url,alt:"pinImage",width:300,height:300,sizes:"300px",priority:!0,placeholder:"blur",blurDataURL:j.loading_image_url,className:"h-auto w-full rounded-3xl bg-neutral animate-pulse",onLoadingComplete:_})}),(0,n.jsx)("div",{className:"pl-3 pr-3 font-bold overflow-clip",children:j.title}),(0,n.jsxs)("div",{className:"flex max-w-full items-center gap-2 pl-3 pr-3",children:[(0,n.jsx)("div",{className:"avatar aspect-square",children:(0,n.jsx)("div",{className:"w-8 rounded-full flex items-center",children:j.users.profile_picture_url?(0,n.jsx)(o(),{src:j.users.profile_picture_url,alt:"avatar",width:"0",height:"0",className:"w-full aspect-square",id:"profilePicture"}):(0,n.jsx)(a.Z,{className:"w-full aspect-square"})})}),(0,n.jsx)("div",{children:j.users.username})]})]}),!j&&(0,n.jsx)("div",{className:"aspect-square w-full animate-ping"})]})},x=e=>{let{props:t}=e,[s,r]=(0,l.useState)(["dummy"]);return(0,n.jsx)("div",{className:"h-max flex flex-col gap-5 w-72 overflow-hidden",children:s&&s.map((e,s)=>(0,n.jsx)(m,{props:{...t,setPinsToDisplay:r}},s))})},f=e=>{let{props:t}=e,{feeds:s}=t,r=(0,l.useRef)(-1),[a,i]=(0,l.useState)(["dummy"]);return(0,l.useEffect)(()=>{let e=e=>{let t=[],s=e?e.target.innerWidth:window.innerWidth,r=Math.floor(s/300);for(let e=0;e<r;e++)t.push("dummy");i(t)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,l.useEffect)(()=>{let e=window.innerWidth,t=Math.floor(e/300),s=[];for(let e=0;e<t;e++)s.push("dummy");i(s)},[]),(0,n.jsx)("div",{children:s&&(0,n.jsx)("div",{className:"flex gap-5 justify-center p-5",children:0!==s.length&&a&&a.map((e,s)=>(0,n.jsx)(x,{props:{...t,index:r}},s))})})}}}]);