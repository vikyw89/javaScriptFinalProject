(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{8684:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/createPin",function(){return a(4003)}])},3263:function(e,t,a){"use strict";a.d(t,{T:function(){return j}});var s=a(5893),l=a(1163),r=a(7294),n=a(554);let i=()=>{let e=(0,l.useRouter)(),t=(0,n.ay)("route"),a=(0,n.ay)("signIn"),i=(0,n.ay)("signOut"),o=(0,n.ay)("auth"),d=(0,n.ay)("boards"),c=(0,n.ay)("pin"),u=(0,n.ay)("initialize"),x=(0,n.ay)("downloadPins"),m=(0,n.ay)("users");return(0,r.useEffect)(()=>{let t=()=>{(0,n.cA)("route.loading",!0)},a=()=>{(0,n.cA)("route.loading",!1)};return e.events.on("routeChangeStart",t),e.events.on("routeChangeComplete",a),()=>{e.events.off("routeChangeStart",t),e.events.off("routeChangeComplete",a)}},[e]),(0,s.jsx)("div",{className:"fixed z-50 top-12 w-full flex",children:(t.loading||a.loading||i.loading||o.loading||d.loading||c.loading||u.loading||x.loading||m.loading)&&(0,s.jsx)("progress",{className:"progress progress-accent"})})};var o=a(9557),d=a(5675),c=a.n(d),u=a(8201),x=a(6540),m=a(3540),h=a(9485),g=a(5328);let p=()=>{var e,t,a;let r=(0,n.C0)("theme"),i=(0,n.ay)("auth"),d=(0,l.useRouter)(),p=null==i?void 0:null===(e=i.data)||void 0===e?void 0:null===(t=e.user)||void 0===t?void 0:null===(a=t.user_metadata)||void 0===a?void 0:a.avatar_url,f=()=>{(0,n.cA)("show.signInComponent",!0)},j=()=>{(0,n.Gt)("signOut",async()=>{let{error:e}=await o.O.auth.signOut();return e})},b=()=>{d.push("/")},w=()=>{d.push("/createPin")},v=async e=>{let t=e.target.textContent;await (0,n.JX)("users",async()=>{let e=await o.O.from("users").update({theme:t}).eq("uuid",i.data.user.id).select();return e.data[0]}),(0,n.zT)("users.data.theme",t)};return(0,s.jsxs)("div",{className:"flex bg-neutral z-20 items-center text-neutral-content",children:[(0,s.jsx)("div",{className:"flex-1 px-2 lg:flex-none flex items-center gap-1 cursor-pointer",children:(0,s.jsxs)("div",{onClick:b,className:"lg:flex-none flex items-center gap-1 cursor-pointer",children:[(0,s.jsx)("div",{className:"w-12",children:(0,s.jsx)(c(),{alt:"pinterest logo",src:"https://hffebrjtrzopihuffrxv.supabase.co/storage/v1/object/public/assets/p-logo-lowres.png",width:"0",height:"0",sizes:"100vw",className:"w-auto"})}),(0,s.jsx)("a",{className:"text-lg font-bold hidden sm:block",children:"Pinterest"})]})}),(0,s.jsxs)("div",{className:"flex justify-end flex-1 px-2 items-center",children:[i.data&&(0,s.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:w,children:[(0,s.jsx)("a",{className:"hidden sm:block",children:"Create"}),(0,s.jsx)("div",{className:" sm:hidden",children:(0,s.jsx)(x.Z,{})})]}),(0,s.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,s.jsxs)("button",{tabIndex:0,className:"btn p-2 btn-ghost rounded-btn",children:[(0,s.jsx)("label",{className:"hidden sm:block",children:"Theme"}),(0,s.jsx)("div",{className:"sm:hidden",children:(0,s.jsx)(g.Z,{})})]}),(0,s.jsx)("ul",{tabIndex:0,className:"menu dropdown-content p-2 shadow rounded-box w-52 mt-4 grid grid-cols-1 overflow-y-scroll max-h-screen bg-neutral",children:r.map((e,t)=>(0,s.jsx)("li",{className:"text-neutral-content bg-neutral",children:(0,s.jsx)("a",{onClick:v,children:e})},t))})]}),i.data?(0,s.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:j,children:[(0,s.jsx)("a",{className:"hidden sm:block",children:"Sign Out"}),(0,s.jsx)("div",{className:"sm:hidden",children:(0,s.jsx)(m.Z,{})})]}):(0,s.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:f,children:[(0,s.jsx)("a",{className:"hidden sm:block",children:"Sign In"}),(0,s.jsx)("div",{className:"sm:hidden",children:(0,s.jsx)(h.Z,{})})]}),(0,s.jsx)("button",{className:"btn btn-ghost rounded-btn",children:(0,s.jsx)("div",{className:"avatar aspect-square",children:(0,s.jsx)("div",{className:"w-8 rounded-full flex items-center",children:p?(0,s.jsx)(c(),{src:p,alt:"avatar",width:"0",height:"0",className:"w-auto h-auto",id:"user_avatar"}):(0,s.jsx)(u.Z,{className:"text-3xl"})})})})]})]})},f=()=>{let e=(0,n.ay)("auth"),t=(0,n.ay)("boards"),a=(0,n.ay)("pin"),l=(0,n.ay)("initialize");return(0,s.jsxs)("div",{className:"fixed bottom-0 left-0",children:[e.error&&(0,s.jsx)("div",{className:"alert alert-error shadow-lg",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{children:e.error.message})]})}),t.error&&(0,s.jsx)("div",{className:"alert alert-error shadow-lg",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{children:t.error.message})]})}),a.error&&(0,s.jsx)("div",{className:"alert alert-error shadow-lg",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{children:a.error.message})]})}),l.error&&(0,s.jsx)("div",{className:"alert alert-error shadow-lg",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsx)("span",{children:l.error.message})]})})]})},j=e=>{let{children:t}=e;return(0,s.jsxs)("div",{className:"fixed top-0 left-0 bottom-0 right-0 flex flex-col bg-base-100 text-base-content",children:[(0,s.jsx)(p,{}),(0,s.jsx)(i,{}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto flex flex-col",children:t}),(0,s.jsx)(f,{})]})}},4003:function(e,t,a){"use strict";a.r(t);var s=a(5893),l=a(3263),r=a(9557),n=a(4970),i=a(9369),o=a(5675),d=a.n(o),c=a(7294),u=a(554),x=a(7632),m=a(221);let h={title:"",description:"",link_url:"",image_url:"",creator_uuid:"",loading_image_url:""},g=()=>{let e=(0,u.ay)("auth",{initialState:{loading:!0}}),t=(0,u.ay)("boards"),[a,o]=(0,c.useState)(h),[g,p]=(0,c.useState)(""),f=(0,c.useId)();(0,c.useEffect)(()=>{e.data&&(0,u.JX)("boards",async()=>{let t=await r.O.from("boards").select().filter("creator_uuid","eq",e.data.user.id).throwOnError();return t.data})},[e.data]),(0,c.useEffect)(()=>{let e=document.querySelector("#".concat(CSS.escape(f)));""===a.image_url?e.classList.add("btn-disabled"):e.classList.remove("btn-disabled")},[a.image_url,f]),(0,c.useEffect)(()=>{var e;t.data&&p(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e[0])},[t.data]);let j=async e=>{e.stopPropagation();let t=e.target.files[0],a="image/gif"!==t.type?URL.createObjectURL(await (0,m.Z)(t,{maxSizeMB:1,maxWidthOrHeight:2048,useWebWorker:!0,fileType:"image/webp",maxIteration:20})):t.size<=1e6&&URL.createObjectURL(t);if(!a)return;let s=await (0,m.Z)(t,{maxSizeMB:25e-5,maxWidthOrHeight:100,useWebWorker:!0,fileType:"image/webp",maxIteration:20}),l=await m.Z.getDataUrlFromFile(s);o(e=>({...e,image_url:a,loading_image_url:l}))},b=e=>{let t={pinTitle:"title",pinDescription:"description",pinLink:"link_url",pinImageURL:"image_url",pinLoadingURL:"loading_image_url"}[e.target.id],a=e.target.value;o(e=>({...e,[t]:a}))},w=()=>{o(e=>({...e,image_url:h.image_url,loading_image_url:h.loading_image_url}))},v=e=>{p(JSON.parse(e.target.value))},N=async()=>{""!==a.image_url&&(await (0,u.Gt)("pin",async()=>{let t=await fetch(a.image_url),s=await t.blob(),l="pins/".concat(e.data.user.id,"/").concat((0,x.Z)()),n=await r.O.storage.from("pins").upload(l,s);n.error&&((0,u.zT)("pin.error",n.error),setTimeout(()=>{(0,u.zT)("pin.error",!1)},1e4));let i=r.O.storage.from("pins").getPublicUrl(l).data.publicUrl,o={title:a.title,description:a.description,link_url:a.link_url,creator_uuid:e.data.user.id,board_uuid:g.uuid,image_url:i,loading_image_url:a.loading_image_url},d=await r.O.rpc("create_pin",o);return d}),o(h))};return(0,s.jsx)(l.T,{children:(0,s.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,s.jsx)("div",{className:"flex items-center justify-center p-10 max-w-5xl rounded-box bg-neutral text-neutral-content w-full",children:(0,s.jsxs)("div",{className:"flex flex-col flex-1 gap-1",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(i.Z,{className:"text-4xl"}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsx)("select",{className:"select max-w-xs bg-neutral text-neutral-content",onChange:v,children:t.data&&t.data.map((e,t)=>(0,s.jsx)("option",{value:JSON.stringify(e),children:e.title},t))}),(0,s.jsx)("button",{id:f,onClick:N,className:"btn btn-primary rounded-btn",children:"Save"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col bg-neutral text-neutral-content min-w-[300px]",children:[""!==a.image_url&&(0,s.jsxs)("div",{className:"flex-1 relative flex-col gap-2 rounded-box aspect-auto",children:[(0,s.jsx)(d(),{src:a.image_url,alt:"uploaded_image",width:"0",height:"0",sizes:"100vw",className:"w-full h-auto",id:"pinImageURL"}),(0,s.jsx)("button",{onClick:w,className:"btn btn-circle absolute z-100 top-0 right-0 rounded-btn animate-pulse",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),""===a.image_url&&(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsxs)("div",{className:" aspect-square flex flex-col items-center justify-center relative border-opacity-50 border-neutral-content border-4 border-dashed rounded-box",children:[(0,s.jsx)(n.Z,{className:"animate-bounce text-6xl"}),(0,s.jsx)("div",{className:"text-lg",children:"click to upload"}),(0,s.jsx)("input",{className:"w-full h-full absolute left-0 top-0 opacity-0",type:"file",accept:"image/bmp,image/gif,image/jpeg,image/png,image/tiff,image/webp",onChange:j})]})})]}),(0,s.jsxs)("div",{id:"createPinInput",className:"text-base-content flex flex-col justify-between flex-1 min-w-[300px] gap-1",children:[(0,s.jsx)("input",{id:"pinTitle",value:a.title,onChange:b,type:"text",placeholder:"Type your title",className:"input input-bordered w-full bg-neutral-focus text-neutral-content rounded-box p-5"}),(0,s.jsx)("textarea",{id:"pinDescription",value:a.description,onChange:b,type:"text",placeholder:"Tell everyone what your pin is about",className:"input input-bordered w-full bg-neutral-focus text-neutral-content break-words placeholder:break-words h-full rounded-box p-5"}),(0,s.jsx)("input",{id:"pinLink",value:a.link,onChange:b,type:"text",placeholder:"Add destination link",className:"input input-bordered w-full bg-neutral-focus text-neutral-content rounded-box p-5"})]})]})]})})})})};t.default=g}},function(e){e.O(0,[969,819,774,888,179],function(){return e(e.s=8684)}),_N_E=e.O()}]);