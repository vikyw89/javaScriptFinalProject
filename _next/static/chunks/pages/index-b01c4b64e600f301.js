(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(4507)}])},1243:function(e,t,s){"use strict";s.d(t,{T:function(){return N}});var a=s(5893),n=s(1163),l=s(7294),r=s(664);let i=()=>{let e=(0,n.useRouter)(),t=(0,r.m)("route/loading"),s=(0,r.m)("loadingCounter");return(0,l.useEffect)(()=>{let t=()=>{(0,r._)("route/loading",!0)},s=()=>{(0,r._)("route/loading",!1)};return e.events.on("routeChangeStart",t),e.events.on("routeChangeComplete",s),()=>{e.events.off("routeChangeStart",t),e.events.off("routeChangeComplete",s)}},[e]),(0,a.jsx)("div",{className:"fixed z-50 top-12 w-full flex",children:(t||s>0)&&(0,a.jsx)("progress",{className:"progress progress-accent"})})};var o=s(9744);let d=()=>{let e=(0,r.m)("theme");return(0,l.useEffect)(()=>{(0,r._)("theme",["light","dark","cupcake","bumblebee","emerald","corporate","synthwave","retro","cyberpunk","valentine","halloween","garden","forest","aqua","lofi","pastel","fantasy","wireframe","black","luxury","dracula","cmyk","autumn","business","acid","lemonade","night","coffee","winter"].sort((e,t)=>e>t?1:-1))},[]),e};var c=s(7997),u=s(9557),h=s(8201),x=s(6540),m=s(5328),p=s(9485),f=s(3540),g=s(5675),v=s.n(g),j=s(4334);let b=()=>{var e,t,s,l,i,g;let b=null!==(g=d())&&void 0!==g?g:[],w=(0,o.a)(),N=(0,c.a)(),_=(0,n.useRouter)(),k=(0,j.Z)("api/auth",async()=>{let{error:e}=await u.O.auth.signOut();return e}),y=(0,j.Z)((null==w?void 0:null===(e=w.data)||void 0===e?void 0:null===(t=e.user)||void 0===t?void 0:t.id)&&"api/user/".concat(w.data.user.id),async(e,t)=>{let{arg:s}=t;await u.O.from("users").update({theme:s}).eq("uuid",w.data.user.id).throwOnError()}),C=null==w?void 0:null===(s=w.data)||void 0===s?void 0:null===(l=s.user)||void 0===l?void 0:null===(i=l.user_metadata)||void 0===i?void 0:i.avatar_url,E=()=>{(0,r._)("show/signInComponent",!0)},T=()=>{k.trigger()},P=()=>{_.push("/")},L=()=>{_.push("/createPin")},I=e=>{let t=e.target.textContent,s={optimisticData:{...N.data,theme:t}};y.trigger(t,s)},O=()=>{_.push("/profile")};return(0,a.jsxs)("div",{className:"flex bg-neutral z-20 items-center text-neutral-content",children:[(0,a.jsx)("div",{className:"flex-1 px-2 lg:flex-none flex items-center gap-1 cursor-pointer",children:(0,a.jsxs)("div",{onClick:P,className:"lg:flex-none flex items-center gap-1 cursor-pointer",children:[(0,a.jsx)("div",{className:"w-12",children:(0,a.jsx)(v(),{alt:"pinterest logo",src:"https://hffebrjtrzopihuffrxv.supabase.co/storage/v1/object/public/assets/p-logo-lowres.png",width:"0",priority:!0,height:"0",sizes:"100vw",className:"w-auto"})}),(0,a.jsx)("a",{className:"text-lg font-bold hidden sm:block",children:"Pinterest"})]})}),(0,a.jsxs)("div",{className:"flex justify-end flex-1 px-2 items-center",children:[w.data&&(0,a.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:L,children:[(0,a.jsx)("a",{className:"hidden sm:block",children:"Create"}),(0,a.jsx)("div",{className:" sm:hidden",children:(0,a.jsx)(x.Z,{})})]}),(0,a.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,a.jsxs)("button",{tabIndex:0,className:"btn p-2 btn-ghost rounded-btn",children:[(0,a.jsx)("label",{className:"hidden sm:block",children:"Theme"}),(0,a.jsx)("div",{className:"sm:hidden",children:(0,a.jsx)(m.Z,{})})]}),(0,a.jsx)("ul",{tabIndex:0,className:"menu dropdown-content p-2 shadow rounded-box w-52 mt-4 grid grid-cols-1 overflow-y-scroll max-h-screen bg-neutral",children:b&&b.map((e,t)=>(0,a.jsx)("li",{className:"text-neutral-content bg-neutral",children:(0,a.jsx)("a",{onClick:I,children:e})},t))})]}),w.data?(0,a.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:T,children:[(0,a.jsx)("a",{className:"hidden sm:block",children:"Sign Out"}),(0,a.jsx)("div",{className:"sm:hidden",children:(0,a.jsx)(f.Z,{})})]}):(0,a.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:E,children:[(0,a.jsx)("a",{className:"hidden sm:block",children:"Sign In"}),(0,a.jsx)("div",{className:"sm:hidden",children:(0,a.jsx)(p.Z,{})})]}),(0,a.jsx)("button",{className:"btn btn-ghost rounded-btn",onClick:O,children:(0,a.jsx)("div",{className:"avatar aspect-square",children:(0,a.jsx)("div",{className:"w-8 rounded-full flex items-center",children:C?(0,a.jsx)(v(),{src:C,alt:"avatar",width:"0",height:"0",className:"w-auto h-auto",id:"user_avatar"}):(0,a.jsx)(h.Z,{className:"text-3xl"})})})})]})]})},w=()=>{let e=(0,r.m)("error");return(0,a.jsx)("div",{className:"fixed bottom-0 left-0",children:e&&(0,a.jsx)("div",{className:"alert alert-error shadow-lg",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("span",{children:e.message})]})})})},N=e=>{let{children:t}=e;return(0,a.jsxs)("div",{className:"fixed top-0 left-0 bottom-0 right-0 flex flex-col bg-base-100 text-base-content",children:[(0,a.jsx)(b,{}),(0,a.jsx)(i,{}),(0,a.jsx)("main",{className:"flex-1 overflow-y-auto flex flex-col",children:t}),(0,a.jsx)(w,{})]})}},4507:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var a=s(5893),n=s(1243),l=s(9557),r=s(7294),i=s(9770),o=s(8201),d=s(5675),c=s.n(d),u=s(1163),h=s(5591),x=s(664);(0,x._)("index",0);let m=e=>{var t;let{props:s}=e,n=(0,r.useId)(),[l,d]=(0,r.useState)(),p=(0,i.Z)("feeds"),f=null===(t=p.data)||void 0===t?void 0:t[l],g=p.data.length,v=(0,u.useRouter)(),j=(0,r.useRef)(null);(0,r.useEffect)(()=>((0,x._)("index",e=>(e||(e=0),d(e),e+1)),()=>{(0,x._)("index",e=>e-1)}),[]),(0,r.useEffect)(()=>{g<=(null!=l?l:50)&&(0,h.JG)("feeds")},[l,g]),(0,r.useEffect)(()=>{let e=j.current,t=new IntersectionObserver(n=>{n.forEach(n=>{let l=n.isIntersecting;l&&(s.setPinsToDisplay(e=>[...e,(0,a.jsx)(m,{props:{setPinsToDisplay:s.setPinsToDisplay}},e.length)]),t.unobserve(e))})});return t.observe(e),()=>{t.unobserve(e)}},[s]);let b=()=>{v.push("/pin/".concat(f.uuid))},w=e=>{e.classList.remove("animate-pulse"),e.removeEventListener("onLoadingComplete",w)};return(0,a.jsxs)("div",{id:n,className:"flex flex-col relative gap-1",onClick:b,ref:j,children:[f&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-72 h-auto",children:(0,a.jsx)(c(),{src:f.image_url,alt:"pinImage",width:300,height:300,sizes:"300px",priority:!0,placeholder:"blur",blurDataURL:f.loading_image_url,className:"h-auto w-full rounded-3xl bg-neutral animate-pulse",onLoadingComplete:w})}),(0,a.jsx)("div",{className:"pl-3 pr-3 font-bold overflow-clip",children:f.title}),(0,a.jsxs)("div",{className:"flex max-w-full items-center gap-2 pl-3 pr-3",children:[(0,a.jsx)("div",{className:"avatar aspect-square",children:(0,a.jsx)("div",{className:"w-8 rounded-full flex items-center",children:f.users.profile_picture_url?(0,a.jsx)(c(),{src:f.users.profile_picture_url,alt:"avatar",width:"0",height:"0",className:"w-full aspect-square",id:"profilePicture"}):(0,a.jsx)(o.Z,{className:"w-full aspect-square"})})}),(0,a.jsx)("div",{children:f.users.username})]})]}),!f&&(0,a.jsx)("div",{className:"aspect-square w-full animate-ping"})]})},p=()=>{let[e,t]=(0,r.useState)([]);return(0,r.useEffect)(()=>{t([(0,a.jsx)(m,{props:{setPinsToDisplay:t}},0)])},[]),(0,a.jsx)("div",{className:"h-max flex flex-col gap-5 w-72",children:e})},f=()=>{let[e,t]=(0,r.useState)(),[s,o]=(0,r.useState)(!1),d=(0,i.Z)("feeds",async()=>{let e=d.data;if(s)return[...e,...e];e||(e=[]);let t=e.length,a=await l.O.from("pins").select("*,\n        users(*)").order("inserted_at",{ascending:!1}).range(t,t+50);return a.data.length<50&&o(!0),[...e,...a.data]});return(0,r.useEffect)(()=>{let e=window.innerWidth,s=Math.floor(e/300),n=[];for(let e=0;e<s;e++)n.push((0,a.jsx)(p,{className:"max-w-xs"},e));t(n);let l=e=>{let s=[],n=e?e.target.innerWidth:window.innerWidth,l=Math.floor(n/300);for(let e=0;e<l;e++)s.push((0,a.jsx)(p,{},e));t(s)};return window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)}},[]),(0,a.jsx)(n.T,{children:d.data&&(0,a.jsx)("div",{className:"flex gap-5 justify-center p-5",children:0!==d.data.length&&e&&e.map(e=>e)})})},g=e=>{let{children:t}=e,s=e=>{"blurredBackground"===e.target.id&&(0,x._)("show/signInComponent",!1)};return(0,a.jsx)("div",{id:"blurredBackground",className:"z-50 bg-base-300 text-base-content bg-opacity-20 fixed top-0 bottom-0 left-0 right-0 flex items-center justify-center",onClick:s,children:(0,a.jsx)("div",{className:"flex flex-col items-center justify-start p-10 max-w-sm rounded-box bg-neutral text-neutral-content",children:t})})},v=()=>{let e=e=>{e.currentTarget.classList.add("loading"),e.currentTarget.classList.add("disabled"),(0,h.JG)("api/auth",async()=>{let e=await l.O.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.href}});return e},{populateCache:!1})};return(0,a.jsxs)(g,{children:[(0,a.jsx)(c(),{alt:"pinterest logo",src:"./p-logo-lowres.png",width:"100",height:"100"}),(0,a.jsx)("p",{className:"font-extrabold text-center",children:"Welcome to Pinterest"}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("button",{className:"btn flex bg-transparent border-accent rounded-box items-center gap-2",onClick:e,children:[(0,a.jsx)(c(),{alt:"google logo",height:"30",width:"30",src:"./Google__G__Logo.svg",style:{aspectRatio:"1"}}),(0,a.jsx)("p",{className:"text-neutral-content",children:"Continue with Google"})]}),(0,a.jsx)("p",{className:"text-center text-xs",children:"By continuing, you agree to Pinterest's Terms of Service and acknowledge you've read our Privacy Policy Notice at collection."})]})]})};var j=s(9744);let b=()=>{let e=(0,j.a)(),t=(0,x.m)("show/signInComponent",!0);return(0,a.jsxs)(n.T,{children:[!e.data&&t&&(0,a.jsx)(v,{}),(0,a.jsx)(f,{})]})};var w=b}},function(e){e.O(0,[576,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);