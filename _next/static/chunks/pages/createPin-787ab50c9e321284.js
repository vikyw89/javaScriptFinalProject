(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{8684:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/createPin",function(){return a(3690)}])},1243:function(e,t,a){"use strict";a.d(t,{T:function(){return k}});var l=a(5893),s=a(1163),n=a(7294),i=a(664);let r=()=>{let e=(0,s.useRouter)(),t=(0,i.m)("route/loading"),a=(0,i.m)("loadingCounter");return(0,n.useEffect)(()=>{let t=()=>{(0,i._)("route/loading",!0)},a=()=>{(0,i._)("route/loading",!1)};return e.events.on("routeChangeStart",t),e.events.on("routeChangeComplete",a),()=>{e.events.off("routeChangeStart",t),e.events.off("routeChangeComplete",a)}},[e]),(0,l.jsx)("div",{className:"fixed z-50 top-12 w-full flex",children:(t||a>0)&&(0,l.jsx)("progress",{className:"progress progress-accent"})})};var o=a(9744);let d=()=>{let e=(0,i.m)("theme");return(0,n.useEffect)(()=>{(0,i._)("theme",["light","dark","cupcake","bumblebee","emerald","corporate","synthwave","retro","cyberpunk","valentine","halloween","garden","forest","aqua","lofi","pastel","fantasy","wireframe","black","luxury","dracula","cmyk","autumn","business","acid","lemonade","night","coffee","winter"].sort((e,t)=>e>t?1:-1))},[]),e};var c=a(7997),u=a(9557),m=a(8201),x=a(6540),h=a(5328),p=a(9485),g=a(3540),f=a(5675),v=a.n(f),b=a(4334);let j=()=>{var e,t,a,n,r,f;let j=null!==(f=d())&&void 0!==f?f:[],w=(0,o.a)(),N=(0,c.a)(),k=(0,s.useRouter)(),_=(0,b.Z)("api/auth",async()=>{let{error:e}=await u.O.auth.signOut();return e}),y=(0,b.Z)((null==w?void 0:null===(e=w.data)||void 0===e?void 0:null===(t=e.user)||void 0===t?void 0:t.id)&&"api/user/".concat(w.data.user.id),async(e,t)=>{let{arg:a}=t;await u.O.from("users").update({theme:a}).eq("uuid",w.data.user.id).throwOnError()}),C=null==w?void 0:null===(a=w.data)||void 0===a?void 0:null===(n=a.user)||void 0===n?void 0:null===(r=n.user_metadata)||void 0===r?void 0:r.avatar_url,L=()=>{(0,i._)("show/signInComponent",!0)},z=()=>{_.trigger()},Z=()=>{k.push("/")},O=()=>{k.push("/createPin")},S=e=>{let t=e.target.textContent;if(w.data){let e={optimisticData:{...N.data,theme:t}};y.trigger(t,e)}else document.querySelector("html").setAttribute("data-theme",t)},W=()=>{k.push("/profile")};return(0,l.jsxs)("div",{className:"flex bg-neutral z-20 items-center text-neutral-content",children:[(0,l.jsx)("div",{className:"flex-1 px-2 lg:flex-none flex items-center gap-1 cursor-pointer",children:(0,l.jsxs)("div",{onClick:Z,className:"lg:flex-none flex items-center gap-1 cursor-pointer",children:[(0,l.jsx)("div",{className:"w-12",children:(0,l.jsx)(v(),{alt:"pinterest logo",src:"https://hffebrjtrzopihuffrxv.supabase.co/storage/v1/object/public/assets/p-logo-lowres.png",width:"0",priority:!0,height:"0",sizes:"100vw",className:"w-auto"})}),(0,l.jsx)("a",{className:"text-lg font-bold hidden sm:block",children:"Pinterest"})]})}),(0,l.jsxs)("div",{className:"flex justify-end flex-1 px-2 items-center",children:[w.data&&(0,l.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:O,children:[(0,l.jsx)("a",{className:"hidden sm:block",children:"Create"}),(0,l.jsx)("div",{className:" sm:hidden",children:(0,l.jsx)(x.Z,{})})]}),(0,l.jsxs)("div",{className:"dropdown dropdown-end",children:[(0,l.jsxs)("button",{tabIndex:0,className:"btn p-2 btn-ghost rounded-btn",children:[(0,l.jsx)("label",{className:"hidden sm:block",children:"Theme"}),(0,l.jsx)("div",{className:"sm:hidden",children:(0,l.jsx)(h.Z,{})})]}),(0,l.jsx)("ul",{tabIndex:0,className:"menu dropdown-content p-2 shadow rounded-box w-52 mt-4 grid grid-cols-1 overflow-y-scroll max-h-screen bg-neutral z-50",children:j&&j.map((e,t)=>(0,l.jsx)("li",{className:"text-neutral-content bg-neutral z-50",children:(0,l.jsx)("a",{onClick:S,children:e})},t))})]}),w.data?(0,l.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:z,children:[(0,l.jsx)("a",{className:"hidden sm:block",children:"Sign Out"}),(0,l.jsx)("div",{className:"sm:hidden",children:(0,l.jsx)(g.Z,{})})]}):(0,l.jsxs)("button",{className:"btn btn-ghost rounded-btn p-2",onClick:L,children:[(0,l.jsx)("a",{className:"hidden sm:block",children:"Sign In"}),(0,l.jsx)("div",{className:"sm:hidden",children:(0,l.jsx)(p.Z,{})})]}),(0,l.jsx)("button",{className:"btn btn-ghost rounded-btn flex items-center justify-center",onClick:W,children:(0,l.jsx)("div",{className:"avatar aspect-square",children:C?(0,l.jsx)("div",{className:"rounded-full flex items-center w-7",children:(0,l.jsx)(v(),{src:C,alt:"avatar",width:"6",height:"6",className:"aspect-square w-2",id:"user_avatar"})}):(0,l.jsx)(m.Z,{className:"text-2xl"})})})]})]})};var w=a(7632);let N=()=>{var e,t,a,s;let n=null!==(e=(0,i.m)("notif/error"))&&void 0!==e?e:[],r=null!==(t=(0,i.m)("notif/warning"))&&void 0!==t?t:[],o=null!==(a=(0,i.m)("notif/info"))&&void 0!==a?a:[],d=null!==(s=(0,i.m)("notif/success"))&&void 0!==s?s:[],c=()=>{};return(0,l.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 w-full flex flex-col cursor-pointer gap-2",children:[n&&n.map(e=>(0,l.jsx)("div",{className:"alert alert-error shadow-lg animate-bounce w-fit",onClick:c,children:(0,l.jsxs)("div",{children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,l.jsx)("span",{children:e.message})]})},(0,w.Z)())),r&&r.map(e=>(0,l.jsx)("div",{className:"alert alert-warning shadow-lg animate-bounce w-fit",onClick:c,children:(0,l.jsxs)("div",{children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,l.jsx)("span",{children:e})]})},(0,w.Z)())),o&&0!==o.length&&(0,l.jsx)("div",{className:"alert alert-info shadow-lg animate-bounce w-fit",onClick:c,children:(0,l.jsxs)("div",{children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,l.jsx)("span",{children:o.slice(-1)})]})},(0,w.Z)()),d&&d.map(e=>(0,l.jsx)("div",{className:"alert alert-success shadow-lg animate-bounce w-fit",onClick:c,children:(0,l.jsxs)("div",{children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,l.jsx)("span",{children:e})]})},(0,w.Z)()))]})},k=e=>{let{children:t}=e;return(0,l.jsxs)("div",{className:"fixed top-0 left-0 bottom-0 right-0 flex flex-col bg-base-100 text-base-content",children:[(0,l.jsx)(j,{}),(0,l.jsx)(r,{}),(0,l.jsx)("main",{className:"flex-1 overflow-y-auto flex flex-col",children:t}),(0,l.jsx)(N,{})]})}},3690:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var l=a(5893),s=a(1243);let n="https://api.cloudinary.com/v1_1/".concat("dvxeoc3ny","/auto/upload");class i{}i.setStorage=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{folder:void 0,public_id:void 0,tags:void 0,context:void 0},{folder:a,public_id:l,tags:s,context:i}=t,r=new FormData;r.append("file",e),r.append("upload_preset","zfkoz18u"),r.append("api_key","492129581574115"),a&&r.append("folder",a),l&&r.append("public_id",l),s&&r.append("tags",s),i&&r.append("context",i);let o=await fetch(n,{method:"POST",body:r}),d=await o.json();return d.url};var r=a(9744),o=a(7997),d=a(9557),c=a(4970),u=a(9369),m=a(221),x=a(5675),h=a.n(x),p=a(7294),g=a(4334);let f={title:"",description:"",link_url:"",image_url:"",creator_uuid:"",loading_image_url:""},v=()=>{var e;let t=(0,r.a)(),a=(0,o.a)(),n=null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.boards,[x,v]=(0,p.useState)(f),[b,j]=(0,p.useState)(null==n?void 0:n[0]),w=(0,p.useId)(),N=(0,p.useRef)(null),k=(0,g.Z)("api/pin",async()=>{let e=await fetch(x.image_url),a=await e.blob(),l=await m.Z.getDataUrlFromFile(a),s=await i.setStorage(l),n={title:x.title,description:x.description,link_url:x.link_url,creator_uuid:t.data.user.id,board_uuid:b.uuid,image_url:s,loading_image_url:x.loading_image_url},r=await d.O.rpc("create_pin",n);return v(f),r}),_=(0,p.useRef)(null);(0,p.useEffect)(()=>{""===x.image_url?_.current.classList.add("btn-disabled"):_.current.classList.remove("btn-disabled")},[x.image_url,w]);let y=async e=>{e.stopPropagation(),N.current.textContent="processing image...";let t=e.target.files[0],a="image/gif"!==t.type?URL.createObjectURL(await (0,m.Z)(t,{maxSizeMB:1,maxWidthOrHeight:2048,useWebWorker:!0,fileType:"image/webp",maxIteration:20})):t.size<=1e6&&URL.createObjectURL(t);if(!a)return;let l=await (0,m.Z)(t,{maxSizeMB:25e-5,maxWidthOrHeight:100,useWebWorker:!0,fileType:"image/webp",maxIteration:20}),s=await m.Z.getDataUrlFromFile(l);v(e=>({...e,image_url:a,loading_image_url:s}))},C=e=>{let t=e.target.id,a=e.target.value;v(e=>({...e,[t]:a}))},L=()=>{v(e=>({...e,image_url:f.image_url,loading_image_url:f.loading_image_url}))},z=e=>{j(JSON.parse(e.target.value))},Z=async e=>{""!==x.image_url&&(e.target.classList.add("loading"),await k.trigger(),e.target.classList.remove("loading"))};return(0,l.jsx)(s.T,{children:(0,l.jsx)("div",{className:"flex flex-1 items-center justify-center",children:(0,l.jsx)("div",{className:"flex items-center justify-center p-10 max-w-5xl rounded-box bg-neutral text-neutral-content w-full",children:(0,l.jsxs)("div",{className:"flex flex-col flex-1 gap-1",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(u.Z,{className:"text-4xl"}),(0,l.jsx)("div",{className:"flex-1"}),(0,l.jsx)("select",{className:"select max-w-xs bg-neutral text-neutral-content",onChange:z,children:n&&n.map((e,t)=>(0,l.jsx)("option",{value:JSON.stringify(e),children:e.title},t))}),(0,l.jsx)("button",{ref:_,onClick:Z,className:"btn btn-primary rounded-btn",children:"Save"})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center",children:[(0,l.jsxs)("div",{className:"flex-1 flex flex-col bg-neutral text-neutral-content min-w-[300px]",children:[""!==x.image_url&&(0,l.jsxs)("div",{className:"flex-1 relative flex-col gap-2 rounded-box aspect-auto",children:[(0,l.jsx)(h(),{src:x.image_url,alt:"uploaded_image",width:"0",height:"0",sizes:"100vw",className:"w-full h-auto",id:"pinImageURL"}),(0,l.jsx)("button",{onClick:L,className:"btn btn-circle absolute z-100 top-0 right-0 rounded-btn animate-pulse",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),""===x.image_url&&(0,l.jsx)("div",{className:"flex flex-col gap-2",children:(0,l.jsxs)("div",{className:" aspect-square flex flex-col items-center justify-center relative border-opacity-50 border-neutral-content border-4 border-dashed rounded-box",children:[(0,l.jsx)(c.Z,{className:"animate-bounce text-6xl"}),(0,l.jsx)("div",{className:"text-lg",ref:N,children:"click to upload, max size 1MB"}),(0,l.jsx)("input",{className:"w-full h-full absolute left-0 top-0 opacity-0",type:"file",accept:"image/bmp,image/gif,image/jpeg,image/png,image/tiff,image/webp",onChange:y})]})})]}),(0,l.jsxs)("div",{id:"createPinInput",className:"text-base-content flex flex-col justify-between flex-1 min-w-[300px] gap-1",children:[(0,l.jsx)("input",{id:"title",value:x.title,onChange:C,type:"text",placeholder:"Type your title",className:"input input-bordered w-full bg-neutral-focus text-neutral-content rounded-box p-5"}),(0,l.jsx)("textarea",{id:"description",value:x.description,onChange:C,type:"text",placeholder:"Tell everyone what your pin is about",className:"input input-bordered w-full bg-neutral-focus text-neutral-content break-words placeholder:break-words h-full rounded-box p-5"}),(0,l.jsx)("input",{id:"link_url",value:x.link_url,onChange:C,type:"text",placeholder:"Add destination link",className:"input input-bordered w-full bg-neutral-focus text-neutral-content rounded-box p-5"})]})]})]})})})})};var b=v}},function(e){e.O(0,[598,947,774,888,179],function(){return e(e.s=8684)}),_N_E=e.O()}]);